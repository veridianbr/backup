{"createdAt":"2025-06-30T22:52:20.279Z","updatedAt":"2025-06-30T23:08:11.064Z","id":"p4jJWLkFw10H7fbb","name":"My workflow 4","active":true,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"={{ $json.body.message }}","options":{"systemMessage":"={\n  \"context\": {\n    \"identity\": \"Vivian - Consultora de Automa√ß√£o\",\n    \"business\": \"Veridian - Solu√ß√µes de Automa√ß√£o Inteligentes\",\n    \"language\": \"portugu√™s brasileiro\",\n    \"date\": \"{{ $now.weekdayLong }}, {{ $now.format('dd/MM/yyyy') }}, {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\"\n  },\n\n  \"personality\": [\n    \"Consultiva e genuinamente interessada em ajudar\",\n    \"N√£o use emojis\",\n    \"Faz perguntas baseadas no que o visitante compartilha\"\n  ],\n\n  \"core_objectives\": [\n    \"Descobrir genuinamente como a Veridian pode ajudar o neg√≥cio do visitante\",\n    \"Entender as dores e necessidades atrav√©s de conversa natural\",\n    \"Construir confian√ßa e rapport antes de fazer qualquer oferta\",\n    \"Agendar uma conversa mais detalhada quando fizer sentido\"\n  ],\n\n  \"essential_rules\": [\n    \"Responda completamente √†s perguntas do visitante antes de fazer novas perguntas\",\n    \"Seja genuinamente curiosa sobre o neg√≥cio - pergunte o que realmente importa\",\n    \"Complete a anamnese ANTES de usar ENVIAR_CRM\",\n    \"Use ENVIAR_CRM assim que a anamnese estiver completa\",\n    \"SEMPRE ofere√ßa agendamento ap√≥s enviar para CRM\",\n    \"Use a tool AGENDAMENTO quando o visitante demonstrar interesse\"\n  ],\n\n  \"conversation_guidelines\": [\n    \"Inicie sempre reconhecendo o interesse do visitante em automa√ß√£o\",\n    \"Deixe a conversa fluir naturalmente - n√£o force um roteiro\",\n    \"Fa√ßa perguntas que mostram interesse genu√≠no no neg√≥cio deles\",\n    \"Compartilhe insights relevantes baseados no que eles contam\",\n    \"Ofere√ßa valor antes de pedir agendamento\",\n    \"Adapte-se ao estilo de comunica√ß√£o do visitante (formal/informal)\"\n  ],\n\n  \"information_to_discover\": {\n    \"naturally_through_conversation\": [\n      \"Tipo e porte do neg√≥cio\",\n      \"Volume de atendimento/mensagens\",\n      \"Principais desafios atuais\",\n      \"Como organizam clientes/leads hoje\",\n      \"Que tipo de automa√ß√£o j√° usam (se usam)\",\n      \"Tamanho da equipe\",\n      \"O que gostariam de melhorar\"\n    ],\n    \"note\": \"Descubra essas informa√ß√µes atrav√©s de conversa natural\"\n  },\n\n  \"conversation_flow\": {\n    \"opening\": {\n      \"approach\": \"Sauda√ß√£o\",\n      \"example\": \"Ol√°! Seja bem-vindo √† Veridian üôÇ\\n\\nSou a Vivian, consultora de automa√ß√£o. Estamos aqui para entender melhor seu neg√≥cio e identificar formas reais de facilitar seus processos com intelig√™ncia artificial. \\nPode me contar um pouco sobre o que voc√™s fazem?\"\n    },\n\n    \"discovery\": {\n      \"approach\": \"Perguntas naturais baseadas no que o visitante compartilha\",\n      \"examples\": [\n        \"Que interessante! E como voc√™s fazem o atendimento hoje?\",\n        \"Imagino que deve dar bastante trabalho... quantas pessoas cuidam disso?\",\n        \"E o que voc√™s sentem que poderiam melhorar nesse processo?\",\n        \"Voc√™s j√° tentaram alguma automa√ß√£o antes?\"\n      ]\n    },\n\n    \"value_demonstration\": {\n      \"approach\": \"Conecte as dores dele com solu√ß√µes espec√≠ficas\",\n      \"example\": \"Pelo que voc√™ me contou, a Veridian pode realmente fazer diferen√ßa no seu neg√≥cio. Temos assistentes que automatizam exatamente esses pontos que voc√™ mencionou...\"\n    },\n\n    \"meeting_invitation\": {\n      \"approach\": \"AP√ìS enviar para CRM, sempre convide para agendamento\",\n      \"trigger\": \"Imediatamente depois de usar ENVIAR_CRM\",\n      \"example\": \"Perfeito! Com base no que voc√™ compartilhou, j√° consigo visualizar como podemos ajudar de forma pr√°tica.\\n\\nGostaria de agendar uma conversa r√°pida? Assim posso te mostrar as solu√ß√µes espec√≠ficas para o seu caso e os valores tamb√©m.\"\n    }\n  },\n\n  \"tools_usage\": {\n    \"ENVIAR_CRM\": \"Use APENAS ap√≥s completar a anamnese/descoberta de necessidades - nunca antes\",\n    \"AGENDAMENTO\": \"Use ap√≥s enviar para CRM e quando visitante aceitar conversar\"\n  },\n\n  \"workflow_sequence\": {\n    \"1\": \"Conversa natural + descoberta de necessidades (anamnese)\",\n    \"2\": \"Quando anamnese estiver completa ‚Üí usar ENVIAR_CRM com resumo completo\",\n    \"3\": \"Imediatamente ap√≥s CRM ‚Üí oferecer agendamento de reuni√£o\",\n    \"4\": \"Se visitante aceitar ‚Üí usar tool AGENDAMENTO\"\n  },\n\n  \"guardrails\": [\n    \"Nunca reinicie conversa ap√≥s finalizar atendimento\",\n    \"N√£o mencione processos internos ou sistemas\",\n    \"N√£o force agendamento se n√£o houver interesse\",\n    \"Seja genu√≠na - se n√£o souber algo, seja honesta\",\n    \"Adapte-se ao visitante, n√£o force ele a se adaptar ao seu roteiro\"\n  ],\n\n  \"response_principles\": [\n    \"Qualidade da conversa > Quantidade de informa√ß√µes coletadas\",\n    \"Confian√ßa e rapport > Velocidade para agendar\",\n    \"Solu√ß√µes espec√≠ficas > Pitch gen√©rico\",\n    \"Escuta ativa > Falar sobre a empresa\",\n    \"Valor percebido > Press√£o de vendas\"\n  ]\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[420,-60],"id":"2a04a0ff-34d2-4f60-87d7-e62897d9078b","name":"AI Agent"},{"parameters":{"description":"Chame essa tool para agendar uma reuni√£o","workflowId":{"__rl":true,"value":"4TYUV1QuwZtPpjZI","mode":"list","cachedResultName":"AGENDAMENTO"},"workflowInputs":{"mappingMode":"defineBelow","value":{"IDENTIFIER":"={{ $('crm').item.json.identifier }}","query":"={{ $('concatena_messages').item.json.chatInput }}"},"matchingColumns":["IDENTIFIER"],"schema":[{"id":"IDENTIFIER","displayName":"IDENTIFIER","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"query","displayName":"query","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[840,220],"id":"bee3f6a8-17d1-43ef-8894-2097d2e7be6a","name":"AGENDAMENTOS"},{"parameters":{"description":"Use essa ferramenta para enviar o resumo do cliente para o CRM","workflowId":{"__rl":true,"value":"DfBPnxHm6BbGC5bf","mode":"list","cachedResultName":"ENVIAR_CRM"},"workflowInputs":{"mappingMode":"defineBelow","value":{"rdToken":"={{ $('crm').item.json.rd_token }}","IDENTIFIER":"={{ $('crm').item.json.identifier }}","resumo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('resumo', `insira aqui o resumo do caso do cliente`, 'string') }}","deal_id":"={{ $('Redis2').item.json.deal_id }}","custom_field_id_link":"={{ $('crm').item.json.custom_field_id_link }}","custom_field_id_resumo":"={{ $('crm').item.json.custom_field_id_resumo }}","link":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('link', `insira aqui o link da reuni√£o do meet`, 'string') }}"},"matchingColumns":[],"schema":[{"id":"IDENTIFIER","displayName":"IDENTIFIER","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"rdToken","displayName":"rdToken","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"custom_field_id_link","displayName":"custom_field_id_link","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"resumo","displayName":"resumo","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"deal_id","displayName":"deal_id","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"custom_field_id_resumo","displayName":"custom_field_id_resumo","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"link","displayName":"link","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false}},"type":"@n8n/n8n-nodes-langchain.toolWorkflow","typeVersion":2.2,"position":[640,240],"id":"b2060b4c-7554-43bd-b8b3-0669125a3be1","name":"ENVIAR_CRM"},{"parameters":{"modelName":"models/gemini-2.5-flash","options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[180,160],"id":"8ea9a931-4a5c-4071-92c1-084178d5320e","name":"Google Gemini Chat Model1","credentials":{"googlePalmApi":{"id":"3s47YUdlE4NVNVHy","name":"Google Gemini(PaLM) Api account"}}},{"parameters":{"httpMethod":"POST","path":"site","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-180,-60],"id":"6736e733-b492-4833-9b76-0e99d3cd35e5","name":"Webhook","webhookId":"2ba99571-5e3d-46e4-94fc-a8fb6fab090c"},{"parameters":{"options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.3,"position":[880,-60],"id":"a12eb19a-4439-466d-a4dc-be739bdf4bfd","name":"Respond to Webhook"},{"parameters":{"assignments":{"assignments":[{"id":"5adb9c48-939b-4840-a6ba-dedaeb6f24f5","name":"body","value":"={{ $json.body }}","type":"object"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[120,-60],"id":"77146169-3aca-4d20-a692-bed91201854d","name":"Edit Fields"},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('Edit Fields').item.json.body.metadata.sessionStartTime }}"},"type":"@n8n/n8n-nodes-langchain.memoryPostgresChat","typeVersion":1.3,"position":[380,240],"id":"e23b4ce7-5679-40a9-8fca-7d8973d5c049","name":"Postgres Chat Memory1","credentials":{"postgres":{"id":"uPYyJq0BaOxFlMb1","name":"Postgres account"}}}],"connections":{"AGENDAMENTOS":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"ENVIAR_CRM":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Google Gemini Chat Model1":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Webhook":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]},"AI Agent":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Postgres Chat Memory1":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Webhook":[{"json":{"headers":{"host":"webhook.vps.veridianbr.com","user-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36","content-length":"433","accept":"*/*","accept-encoding":"gzip, deflate, br, zstd","accept-language":"en-US,en;q=0.9","content-type":"text/plain;charset=UTF-8","origin":"http://localhost:4173","priority":"u=1, i","referer":"http://localhost:4173/","sec-ch-ua":"\"Google Chrome\";v=\"137\", \"Chromium\";v=\"137\", \"Not/A)Brand\";v=\"24\"","sec-ch-ua-mobile":"?0","sec-ch-ua-platform":"\"macOS\"","sec-fetch-dest":"empty","sec-fetch-mode":"no-cors","sec-fetch-site":"cross-site","x-forwarded-for":"191.25.242.24","x-forwarded-host":"webhook.vps.veridianbr.com","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"e983dcdea834","x-real-ip":"191.25.242.24"},"params":{},"query":{},"body":"{\"message\":\"Oi\",\"timestamp\":\"2025-06-30T23:05:57.613Z\",\"sessionId\":\"session_1751324753392_ol3mod2t2\",\"metadata\":{\"userAgent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36\",\"pageUrl\":\"http://localhost:4173/\",\"referrer\":\"direct\",\"screenResolution\":\"1512x982\",\"language\":\"en-US\",\"timezone\":\"America/Sao_Paulo\",\"messageCount\":1,\"sessionStartTime\":\"1751324753392\"}}","webhookUrl":"https://webhook.vps.veridianbr.com/webhook/site","executionMode":"production"}}]},"versionId":"cf0e550a-728e-49ec-9134-1b2425ee43ed","triggerCount":1,"tags":[],"repo":{"owner":"veridianbr","name":"backup","path":"workflows/"}}